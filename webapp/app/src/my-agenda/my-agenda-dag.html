<link rel="import" href="../my-agenda/my-agenda-les.html">
<dom-module id="my-agenda-dag">
    <template>
        <style>
            :host{
                display: block;
                width: 100%;
            };

            .dagen-agenda {
                border-right: 1px solid #1693c9;
                background: #33aadd;
                padding: 10px;
                text-align: center;
                color: white;
            }

            my-agenda-les {
                border-bottom: 1px solid #ccc;
                border-right: 1px solid #ccc;

            }

        </style>
        <div class="dag">
            <div class="dagen-agenda">[[_fix_date(datum)]]</div>
            <!-- Lelijk en hardcoced
                TODO: automatisch genereren die hap!
             -->
            <my-agenda-les vak="OODC" begin="12:00" eind="13:30" locatie="DL200-4.84" groepen="v1f" docent="dietste.obbink@hu.nl"></my-agenda-les>

            <my-agenda-les vak="OODC" begin="12:00" eind="13:30" locatie="DL200-4.84" groepen="v1f" docent="dietste.obbink@hu.nl"></my-agenda-les>
        </div>
        <iron-ajax
          id="ajax_student_dag_rooster_ophalen_request"
          method="POST"
          url="/student/rooster/dagOphalen"
          handle-as="json"
          on-response="_student_dag_rooster_ophalen_response_handler">
        </iron-ajax>
    </template>
    <script>
        Polymer({
            is: 'my-agenda-dag',
            properties: {
               rol: {
                type: String,
                notify: true,   
              },

              isStudent: {
                    type: Boolean,
                    value: true,
              },

              datum: {
                type: String,
                notify: true,
              },

              c_visible: {
                type: Boolean,
                value: false,
                observer: '_initializing',
              },
              c_username: {
                type: String,
              },
              lessen: {
                type: Array,
              }
            },

            _initializing : function() {
              if(this.c_visible){
                //this._student_dag_rooster_ophalen_request();
              }
            },

            _student_dag_rooster_ophalen_request : function(){
              this.$.ajax_student_dag_rooster_ophalen_request.contentType="application/json";
              this.$.ajax_student_dag_rooster_ophalen_request.body={
                "username":this.c_username,
                "date":this.datum
              };
              this.$.ajax_student_dag_rooster_ophalen_request.generateRequest();
            },

            _student_dag_rooster_ophalen_response_handler : function(response){
              console.log("_student_agenda_ophalen_response_handler ::"+response.detail.response);
            },

            _fix_date : function(dateString){
              var tijd_datum = new Date(dateString);
              var dag = tijd_datum.getDay(); //dag in woorden
              var dag2 = tijd_datum.getDate(); // dag in getal
              var maand = tijd_datum.getMonth()+1; // +1 want js begint bij 0 te tellen

              var maandarray = new Array('JAN', 'FEB', 'MA', 'APR', 'MEI', 'JUN', 'JUL', 'AUG', 'SEP', 'OKT', 'NOV', 'DEC');
              var dagarray = new Array('ZO','MA','DI', 'WO', 'DO', 'VR', 'ZA');
              return(dagarray[dag]+" "+dag2+" "+maandarray[maand]);
            },   
        });
    </script>
</dom-module>